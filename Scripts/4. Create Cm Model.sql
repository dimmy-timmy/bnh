IF schema_id('Cms') IS NULL
    EXECUTE('CREATE SCHEMA [Cms]')
CREATE TABLE [Cms].[Scene] (
    [Id] [bigint] NOT NULL IDENTITY,
    [OwnerGuidId] [uniqueidentifier] NOT NULL,
    [OwnerLongId] [bigint] NOT NULL,
    [OwnerIntId] [int] NOT NULL,
    CONSTRAINT [PK_Cms.Scene] PRIMARY KEY ([Id])
)
CREATE TABLE [Cms].[Walls] (
    [Id] [bigint] NOT NULL IDENTITY,
    [SceneId] [bigint] NOT NULL,
    [Title] [nvarchar](50),
    [Width] [real] NOT NULL,
    [Order] [tinyint] NOT NULL,
    CONSTRAINT [PK_Cms.Walls] PRIMARY KEY ([Id])
)
CREATE INDEX [IX_SceneId] ON [Cms].[Walls]([SceneId])
CREATE TABLE [Cms].[Bricks] (
    [Id] [bigint] NOT NULL IDENTITY,
    [Title] [nvarchar](50),
    [Width] [real] NOT NULL,
    [Order] [tinyint] NOT NULL,
    [ContentTitle] [nvarchar](50),
    [WallId] [bigint] NOT NULL,
    [Html] [nvarchar](max),
    [GpsLocation] [nvarchar](100),
    [Height] [int],
    [Zoom] [int],
    [ImageListId] [bigint],
    [LinkedBrickId] [bigint],
    [Discriminator] [nvarchar](128) NOT NULL,
    CONSTRAINT [PK_Cms.Bricks] PRIMARY KEY ([Id])
)
CREATE INDEX [IX_WallId] ON [Cms].[Bricks]([WallId])
CREATE INDEX [IX_LinkedBrickId] ON [Cms].[Bricks]([LinkedBrickId])
CREATE TABLE [Cms].[SceneTemplates] (
    [Id] [uniqueidentifier] NOT NULL,
    [Title] [nvarchar](max),
    [IconUrl] [nvarchar](max),
    CONSTRAINT [PK_Cms.SceneTemplates] PRIMARY KEY ([Id])
)
ALTER TABLE [Cms].[Walls] ADD CONSTRAINT [FK_Cms.Walls_Cms.Scene_SceneId] FOREIGN KEY ([SceneId]) REFERENCES [Cms].[Scene] ([Id]) ON DELETE CASCADE
ALTER TABLE [Cms].[Bricks] ADD CONSTRAINT [FK_Cms.Bricks_Cms.Walls_WallId] FOREIGN KEY ([WallId]) REFERENCES [Cms].[Walls] ([Id]) ON DELETE CASCADE
ALTER TABLE [Cms].[Bricks] ADD CONSTRAINT [FK_Cms.Bricks_Cms.Bricks_LinkedBrickId] FOREIGN KEY ([LinkedBrickId]) REFERENCES [Cms].[Bricks] ([Id])
CREATE TABLE [dbo].[__MigrationHistory] (
    [MigrationId] [nvarchar](255) NOT NULL,
    [Model] [varbinary](max) NOT NULL,
    [ProductVersion] [nvarchar](32) NOT NULL,
    CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId])
)
BEGIN TRY
    EXEC sp_MS_marksystemobject 'dbo.__MigrationHistory'
END TRY
BEGIN CATCH
END CATCH
INSERT INTO [__MigrationHistory] ([MigrationId], [Model], [ProductVersion]) VALUES ('201206110230117_InitialCreate', 0x1F8B0800000000000400ED5C5B6FDB36147E1FB0FF20E8A91D50CBC9B6222D9C16B937589C1471DA027B09188976884A9426D259BCBFB687FDA4FD8591BA9222A99B1347CDFA16F3F2F1DC78489E73947FFFFE67F2FE3EF0AD3B181314E25D7B6B34B62D88DDD04378B16B2FE9FCD58EFDFEDD8F3F4C8EBCE0DEFA9C8FDBE6E3D84C4C76ED5B4AA3B78E43DC5B1800320A901B87249CD3911B060EF042677B3CDE71B6C60E641036C3B2ACC9E5125314C0E407FB79106217467409FC69E8419F64EDAC6796A05AE7208024022EDCB5A764741090513AD0B6F67C04181133E8CF3B52347EC329B28BB5D86A478C2ABABA5A45305991C1BA104371081BF41B5C490DACE9631C4630A6AB4B38CF269E7AB6E5C8F39CEAC4629A3087AFCDFEC2F4F52FB675BEF47D70E3B38639F009B4ADE8F5DB190D6378C2A88A0185DE4740298C319F0B13DA3319BC8D5EB713C31B67BCCDC5E0008C430A28D3AE427885CC8B3FD9E2274BE495F4F25F1A725BE09C8578D1CC770B203655C2F979BB19E71CDCA145C27305F10BF0B96D5D423FE925B7284A4D6CC47BAE53ABB08EE330B80CFD6C7CDA7A7D05E205A48C9050E99A85CBD8AD5031714A9BABB5448EF3DD10253213A9AE6B3C5788FA308798D198F93DA659740FBD338817F4B6809982FBBCE557E6FC3E61C4BC249B43E32514574D7FD72FFA0579F4B658942DE9C3EE561F7B30CE31F657B40582D1DE3383EE63EFB9516BEC3DDF0A6DA9D88F91FB55BFED92AEEB640F086494ADCAB613BAD6DA76090E3B656E088D814B33F57EDF87FFD72D5441601717CAE4FC341260C6DDD9FBD51E79FDB65ED503687665AFADF781067EB6FDF6018199700B92EC5AE1F0C91D15C2FEECA491D68C5C82BFC258CF89C0A3538B3105516F599C44E42C74B3ADDC49245BE3758DF403448B5B6ABC97B581F83D0C830E00ADD572C22C14C6ABDE623D0DC0029E21426B36E11AE41D0511AD25AEC162AE42778DD967087FE52CF4960E07805E32B0937CEA7C9480A9755512D1D7D2E8D2731907298ECC3C722DBF965C8EAE601031FA9FE02AD1EBADD6E780EBEA4F3544BB21FE143F951FDF232474516263C21979AD0B091C61CF32DF8CCB7D939EA2D3A54F51E423972DBA6BFFA448418B565C704BB4EC5A2EC36DD95503BAC087D087145A7B2E4D82370780B8C053A5CFE4E0C92DCCE660CCEF91C067371D7E054698AA068AB08B22E01B89AECC6869D49CA202BBDA73082388F915D728F7368B162F4875E562818A8C9A44327104BBA93727E166653200DD354BF1E4EDED49F760AAB7CEA7372795E60D98932AF7368BE637F227B126F3E167B286162761691C950B417B9B6B3E459B2C7A3C1A6D290BF4B2A5465A36605A8D526F4343E576B501834BCF48FEDE6533609CBF7F03927420481433E3E367908AAE96D85679D6CAA798623FF2F42C22ABCC4E7D56C3E43CB0A4CCD65C854DA4E71736230BC58DAE0A270854E6278FAB0903D4A85B55B3B5578D82F242608A65D45E2E84F9B9BEAA4E5DE6A605A762FC40E5D47406369D8202A5B9766B58D59C7B4DA2EAC169CDF34365BCA5BBEEE8B0BB89A5D93537E2D58829BF57173EA3CCEA39695A2F4FFF3986FCDF640AA2885DF9857C60D662CDD264E0C1AB59F7AC5F9062382ED124FF0A6A8B956818B3877EA59787FE3C788C62420F010537803F420EBC401DD6EC21F3952447A96A2D773AF970FE77161C1253A223ADDF284577CCB809F87194048EAB3B5E9D972461810F62CD8BF220F49701361F8BE6D952125184913A3AE2E5C944052FEFE88897E51415B8AC5D459B3815212BE7B2A246E5CE2C1B452B93491D587F8BD1B9DF1606A39FF638F652BCD44408E3F3CD8C9305324494ACA93D46967A1031B2A60EF695A61E24D34A9B06635599C3EF6F566570BBBB6D19E63D8E71A5C902717EDAA24560BEDD43C9BBEB33F097729E42843844C48D51803060AC3D865A3BE942C8413C6B6588B996E16AA3C8E60C5C1752E64884913A3AE836CB0649DACDDADAA3A4092111236D69672165266DB8F621A5A6066E23521A4C82113BDAE9464EC90D573F426E6E38DA51A4296610872BCB224F39604996B9D4E1CA510ED00E4798DAD995F8A508D410DAD42BA8129D1E92964E09FFFB62FE42565742E9CBA1EBE95B7C2E9930E45A2D114AEEE9C05996EF915833E4809EEC1957895EAF1957D2D72D2448ADE24BE6F9C335E0A20C4122236FDCB0A295A86A7548B17A115DAD4451275944B3F9530B25C4990EB12D26A03BE4F1F0E66C45280C467CC068F6877FE023C66F39600A309A4342AFC2AF907F36321EEFF4FF64A3284D25C4F335A1DBA7FF6EE3062D1067BFB126B7CF170EF227174B8CFE58429420CE11F784EB7F7E9193BFF6F717CD2803FFEEE1B11459F964A1A7C0A56A2C7C0762F716C44A71F11AF5D43104FE7AD5D414E1D5035A81AE90E11B368367A34015445711FF501C4A05EF3DF78E58189ED3F52200F72FBB52A3A9AAD6F299D450AF53345DE1B26BC9748FE99ACA6655DA6D80B445C0FDA02ACFB83A816FEF3C94DB79E252DDB5CF78ED2EEC65ED9552DC0E580F5A5E9B55CC6CB40856AE98E951CFDBAB54CD94C57F94CAD9E7512CDB4A3D8F641A59E0A97B716EEF12EB8D95C13EC7D2D796EAD2569E5650D267EC8614DF5E210FA1F984B5368B0DA61C55A9C93284C8E4EF9E4D35A969B823A9E1621A4E0FB8F6E5AAC66A551DACBE06515BC86AAE63D5011BCAF66A6B5C9B4B5C8D9211CA643754062BE95028646B2A7D554A408751EBDA8A349D2F535204DF40416B4BD24D4E770D963B14A7AAE152E6B784FF5FC37C27418B128267A73074258F558C39C5F330F79F158AF221959BF71452E03177B617B347007029EB762121C9977045A2F7067AA7F86249A325652CC3E0C65F89C2E00EB86EFDA40257A6797211255F573E040B8C4CC4588017787F897CAFA0FB58F334334070CF9E0560B82E290FC42C5605D27958DDF126A04C7CC5815438AC0B3C0377D04C5BB30C65894D0E1158C420201946399FFD64E6E705F7EFFE0304DE10B781490000, '5.0.0-rc.net40')



insert into [cm].[Wall]([OwnerId], [Title], [Width], [Order]) values('B740A5E9-3463-4FAC-82C3-DBF9F7BA1017', N'Shared Bricks', 100.00, 0)
